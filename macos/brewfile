# Main Brewfile

def hw_model
  return nil unless OS.mac?
  `sysctl -n hw.model`.strip
end

cask_args appdir: "/Applications"

# Global casks
cask "font-sf-pro"
cask "font-sf-mono"
cask "font-sf-mono-nerd-font"
cask "font-sf-compact"
cask "font-new-york"
cask "ghostty"

# Determine external Brewfile based on hardware
brewfile_name = hw_model&.start_with?("Macmini") ? "brewfile-server" : "brewfile-endpoint"
external_file = File.expand_path(brewfile_name, __dir__)

# Execute external Brewfile in memory directly
if File.exist?(external_file)
  puts "✅ Adding brews from external file: #{external_file}"
  instance_eval(File.read(external_file), external_file)
else
  puts "⚠️ Brewfile not found: #{external_file}"
end